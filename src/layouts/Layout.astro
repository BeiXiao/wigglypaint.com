---
export interface Props {
  title: string;
  description: string;
  lang?: string;
}

const { title, description, lang = 'en' } = Astro.props;

// 获取当前页面路径用于生成正确的 hreflang 链接
const currentPath = Astro.url.pathname;
const isRootPage = currentPath === '/' || currentPath === '';

// 生成当前页面的基础路径（去除语言前缀）
let basePath = currentPath;
if (currentPath !== '/') {
  // 移除语言前缀，如 /zh/about/ -> /about/
  basePath = currentPath.replace(/^\/[a-z]{2}(-[A-Z][a-z])?(\/|$)/, '/');
  if (basePath === '') basePath = '/';
}

// 支持的语言列表
const supportedLanguages = [
  { code: 'en', hreflang: 'en', name: 'English' },
  { code: 'zh', hreflang: 'zh-CN', name: '中文' },
  { code: 'zh-Hant', hreflang: 'zh-TW', name: '繁體中文' },
  { code: 'ja', hreflang: 'ja', name: '日本語' },
  { code: 'ko', hreflang: 'ko', name: '한국어' },
  { code: 'ms', hreflang: 'ms', name: 'Bahasa Malaysia' },
  { code: 'id', hreflang: 'id', name: 'Bahasa Indonesia' },
  { code: 'vi', hreflang: 'vi', name: 'Tiếng Việt' },
  { code: 'es', hreflang: 'es', name: 'Español' },
  { code: 'th', hreflang: 'th', name: 'ไทย' },
  { code: 'pt', hreflang: 'pt', name: 'Português' },
  { code: 'pl', hreflang: 'pl', name: 'Polski' },
  { code: 'de', hreflang: 'de', name: 'Deutsch' },
  { code: 'fr', hreflang: 'fr', name: 'Français' }
];

// 生成当前页面所有语言版本的 URL
function generateLocalizedUrl(languageCode: string) {
  if (languageCode === 'en') {
    return `https://wigglypaint.com${basePath === '/' ? '' : basePath}`;
  } else {
    return `https://wigglypaint.com/${languageCode}${basePath}`;
  }
}
---

<!DOCTYPE html>
<html lang={lang}>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- SEO 基础标签 -->
    <title>{title}</title>
    <meta name="description" content={description}>
    <meta name="keywords" content="WigglyPaint,animated drawing tool,wiggly lines,pixel art,free online drawing,GIF maker,digital art,animation creator,meme maker,retro art,comic creator,online drawing app,animated stickers,pixel art generator,doodle tool,no signup drawing">
    <meta name="author" content="Internet Janitor">
    <meta name="robots" content="index, follow">
    <meta name="googlebot" content="index, follow">

    <!-- 语言和地区 -->
    <meta name="language" content={lang}>
    <meta name="geo.region" content="US">

    <!-- Open Graph 标签 (社交媒体分享) -->
    <meta property="og:title" content={title}>
    <meta property="og:description" content={description}>
    <meta property="og:image" content="https://wigglypaint.com/og-img.png">
    <meta property="og:image:alt" content="WigglyPaint - Free Online Animated Drawing Tool">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:type" content="image/png">
    <meta property="og:url" content={generateLocalizedUrl(lang)}>
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="WigglyPaint">
    <meta property="og:locale" content={lang === 'en' ? 'en_US' : lang === 'zh' ? 'zh_CN' : lang === 'zh-Hant' ? 'zh_TW' : lang === 'ja' ? 'ja_JP' : lang === 'ko' ? 'ko_KR' : lang === 'ms' ? 'ms_MY' : lang === 'id' ? 'id_ID' : lang === 'vi' ? 'vi_VN' : lang === 'es' ? 'es_ES' : lang === 'th' ? 'th_TH' : lang === 'pt' ? 'pt_PT' : lang === 'pl' ? 'pl_PL' : lang === 'de' ? 'de_DE' : 'fr_FR'}>
    
    <!-- 添加额外的 Open Graph 标签 -->
    <meta property="article:author" content="Internet Janitor">
    <meta property="og:updated_time" content="2024-12-19T00:00:00+00:00">

    <!-- Twitter Card 标签 -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content={title}>
    <meta name="twitter:description" content={description}>
    <meta name="twitter:image" content="https://wigglypaint.com/og-img.png">
    <meta name="twitter:image:alt" content="WigglyPaint - Free Online Animated Drawing Tool">
    <meta name="twitter:creator" content="@InternetJanitor">
    <meta name="twitter:site" content="@WigglyPaint">
    <meta name="twitter:domain" content="wigglypaint.com">

    <!-- 网站图标 -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="manifest" href="/site.webmanifest">

    <!-- 规范化URL - 动态生成当前页面的正确 URL -->
    <link rel="canonical" href={generateLocalizedUrl(lang)}>

    <!-- 多语言版本 - 动态生成当前页面所有语言版本的链接 -->
    {supportedLanguages.map(language => (
        <link rel="alternate" hreflang={language.hreflang} href={generateLocalizedUrl(language.code)} />
    ))}
    <link rel="alternate" hreflang="x-default" href={generateLocalizedUrl('en')} />

    <!-- 预连接优化 -->
    <link rel="preconnect" href="https://unpkg.com">
    <link rel="dns-prefetch" href="https://unpkg.com">
    <link rel="stylesheet" href="https://unpkg.com/@sakun/system.css" />

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-C8PMPYJE85"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-C8PMPYJE85');
</script>

<!-- End Google Tag Manager -->

    <!-- JSON-LD 结构化数据 - 优化内容 -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "SoftwareApplication",
        "name": "WigglyPaint",
        "description": "Free animated drawing tool for creating pixel art, GIFs and digital artwork with unique wiggly line effects. No signup required.",
        "url": "https://wigglypaint.com",
        "applicationCategory": "DrawingApplication",
        "operatingSystem": "Web Browser",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "creator": {
            "@type": "Person",
            "name": "Internet Janitor"
        },
        "publisher": {
            "@type": "Organization",
            "name": "WigglyPaint",
            "url": "https://wigglypaint.com"
        },
        "keywords": "WigglyPaint, animated drawing tool, wiggly lines, pixel art, free online drawing, GIF maker, digital art, animation creator",
        "screenshot": "https://wigglypaint.com/og-img.png",
        "featureList": [
            "Free animated drawing tool",
            "Unique wiggly line effects",
            "GIF and animation export",
            "No signup required",
            "Privacy focused",
            "Works on all devices",
            "Multiple animated brushes",
            "Pixel art creation"
        ]
    }
    </script>
    <!-- Google AD -->
     <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1251180454262422"
     crossorigin="anonymous"></script>

</head>

<body>
    <slot />
</body>
</html>

<style is:global>
    body {
        margin: 0;
        padding: 0;
        font-family: 'ChicagoFLF', system-ui, -apple-system, sans-serif !important;
        min-height: 100vh;
        box-sizing: border-box;
    }

    body {
        background: linear-gradient(90deg, #fff 18px, transparent 1%) 50%,
            linear-gradient(#fff 18px, transparent 1%) 50%,
            #000;
        background-attachment: fixed;
        background-size: 19px 19px;
    }

    /* Custom menu bar styles */
    ul[role="menu-bar"] {
        border-bottom: 2px solid #000 !important;
        font-size: 18px !important;
        font-weight: bold !important;
        padding: 8px 8px !important;
        display: flex !important;
        justify-content: flex-start !important;
    }

    ul[role="menu-bar"]>li {
        font-size: 18px !important;
        font-weight: bold !important;
    }

    ul[role="menu-bar"] span,
    ul[role="menu-bar"] a {
        font-size: 18px !important;
        font-weight: bold !important;
    }

    ul[role="menu-bar"] li[style*="margin-left: auto"] {
        margin-left: auto !important;
        margin-right: 8px !important;
    }

    /* 修复右侧菜单的子菜单显示问题 */
    ul[role="menu-bar"] li[style*="margin-left: auto"] ul[role="menu"] {
        right: 0 !important;
        left: auto !important;
        transform: translateX(0) !important;
    }

    .main-container {
        max-width: 1200px;
        margin: 0 auto;
    }

    .hero-section {
        text-align: center;
        margin-bottom: 16px;
        font-family: 'Chicago_12' !important;
    }

    .hero-title {
        font-size: 32px;
        font-weight: bold;
        margin: 20px 0 10px 0;
        text-shadow: 1px 1px 0px #fff;
    }

    .hero-subtitle {
        font-weight: bold !important;
        font-size: 32px;
        margin: 0 0 30px 0;
        color: #111;
    }

    .demo-container {
        margin: 30px 0;
        text-align: center;
    }

    .demo-window {
        display: inline-block;
        max-width: 600px;
        width: 100%;
    }

    .demo-iframe {
        width: 100%;
        height: 720px;
        border: none;
        background: white;
        border-radius: 16px;
    }

    .demo-iframe.fullscreen {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        z-index: 9999;
        border-radius: 0;
    }

    .exit-fullscreen-btn {
        position: fixed;
        top: 20px;
        right: 20px;
        background: #c0c0c0;
        color: black;
        border: 2px outset #c0c0c0;
        padding: 8px 12px;
        cursor: pointer;
        font-size: 12px;
        font-family: 'ChicagoFLF', system-ui, -apple-system, sans-serif;
        z-index: 10001;
        min-width: 80px;
        text-align: center;
    }

    .exit-fullscreen-btn:hover {
        background: #d0d0d0;
    }

    .exit-fullscreen-btn:active {
        border: 2px inset #c0c0c0;
        background: #a0a0a0;
    }

    .hero-demo-container {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }

    .hero-content {
        padding: 8px;
        text-align: center;
    }

    .hero-content .hero-title {
        font-size: 32px;
        font-weight: bold;
        margin: 0 0 8px 0;
    }

    .hero-content {
        font-size: 18px;
        font-weight: bold;
        margin: 0 0;
        color: #333;
    }

    .hero-content p {
        margin: 0 0 8px 0;
        line-height: 1.5;
    }

    .demo-content {
        position: relative;
    }

    @media (max-width: 768px) {
        .demo-iframe {
            height: 400px;
        }
    }

    .features-grid {
        display: grid;
        grid-template-columns: repeat(6, 1fr);
        grid-template-rows: repeat(2, 320px);
        gap: 20px;
        margin: 16px 0;
    }

    /* Bento-style layout - 2 rows, perfectly aligned */
    .feature-window:nth-child(1) {
        grid-column: 1 / 4;
        grid-row: 1;
    }

    .feature-window:nth-child(2) {
        grid-column: 4 / 7;
        grid-row: 1;
    }

    .feature-window:nth-child(3) {
        grid-column: 1 / 3;
        grid-row: 2;
    }

    .feature-window:nth-child(4) {
        grid-column: 3 / 7;
        grid-row: 2;
    }

    @media (max-width: 768px) {
        .features-grid {
            grid-template-columns: 1fr;
            grid-template-rows: auto;
        }

        .feature-window:nth-child(1),
        .feature-window:nth-child(2),
        .feature-window:nth-child(3),
        .feature-window:nth-child(4) {
            grid-column: 1;
            grid-row: auto;
        }
    }

    .feature-window {
        min-height: 300px;
    }

    .feature-content {
        padding: 20px;
        line-height: 1.6;
    }

    .feature-content p {
        margin: 0 0 15px 0;
    }

    .feature-title {
        font-weight: bold;
        margin: 15px 0 8px 0;
        color: #333;
    }

    .download-section,
    .faq-section {
        margin: 24px 0;
    }

    .platform-buttons {
        display: flex;
        gap: 20px;
        justify-content: center;
        flex-wrap: wrap;
        margin: 20px 0;
    }

    .platform-btn {
        min-width: 150px;
        text-align: center;
    }

    .faq-item {
        margin: 20px 0;
        border-bottom: 1px solid #ccc;
        padding-bottom: 15px;
    }

    .faq-question {
        font-weight: bold;
        margin: 0 0 8px 0;
        color: #333;
    }

    .faq-answer {
        margin: 0;
        line-height: 1.6;
    }

    /* Footer 样式 */
    .footer-section {
        margin: 24px 0 20px 0;
    }

    .footer-content {
        padding: 20px;
    }

    .footer-main {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 20px;
    }

    .footer-info {
        flex: 1;
    }

    .footer-description {
        font-weight: bold;
        margin: 0 0 8px 0;
        font-size: 14px;
    }

    .footer-tech {
        margin: 0;
        font-size: 12px;
        color: #666;
    }

    .footer-links {
        display: flex;
        gap: 20px;
        flex-wrap: wrap;
    }

    .footer-link {
        text-decoration: none;
        color: black;
        font-size: 12px;
        font-weight: bold;
    }

    .footer-link:hover {
        text-decoration: underline;
    }

    .footer-bottom {
        border-top: 1px solid #ccc;
        padding-top: 15px;
        text-align: center;
    }

    .footer-copyright {
        margin: 0;
        font-size: 11px;
        color: #666;
    }

    @media (max-width: 768px) {
        .footer-main {
            flex-direction: column;
            gap: 15px;
        }

        .footer-links {
            justify-content: center;
        }
    }
</style> 